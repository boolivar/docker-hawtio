plugins {
    id "base"
    id "com.bmuschko.docker-remote-api" version "6.7.0"
}

repositories {
    mavenCentral()
}

configurations {
    hawtio {
        canBeConsumed = false
        canBeResolved = false
        transitive = false
    }
}

dependencies {
    hawtio "io.hawt:hawtio-jbang:3.0.0"
}

version configurations.hawtio.dependencies.version[0]

tasks.named("build") {
    dependsOn "buildImage"
}

tasks.register("buildImage", com.bmuschko.gradle.docker.tasks.image.DockerBuildImage) {
    inputDir = rootDir
    images = ["boolivar/hawtio:$version"]
    buildArgs = [HAWTIO_VERSION: "hawtio-$version", JAVA_VERSION: javaVersion]
}

tasks.register("version") {
    doLast {
        print version
    }
}